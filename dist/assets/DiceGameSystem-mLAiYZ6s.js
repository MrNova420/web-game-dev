import{l as i}from"./index-Bf-_4h4A.js";import"./three-DTQjiZ7L.js";import"./cannon-DPZWuR6y.js";class m{constructor(){this.enabled=!1,this.currentGame=null,this.assets={diceModels:{standard:"/assets/models/dice/d6_standard.glb",golden:"/assets/models/dice/d6_golden.glb",crystal:"/assets/models/dice/d6_crystal.glb",obsidian:"/assets/models/dice/d6_obsidian.glb"},tables:{craps:"/assets/models/casino/craps_table.glb",poker_dice:"/assets/models/casino/poker_table.glb"},casino_environment:"/assets/models/casino/casino_interior.glb",chips:{white:"/assets/models/casino/chip_white.glb",red:"/assets/models/casino/chip_red.glb",blue:"/assets/models/casino/chip_blue.glb",gold:"/assets/models/casino/chip_gold.glb"},ui:{icons:"game-icons.net",panels:"/assets/ui/kenney_ui_pack/",buttons:"/assets/ui/kenney_ui_pack/buttons/"},audio:{dice_roll:"/assets/audio/freesound/dice_roll.ogg",dice_land:"/assets/audio/freesound/dice_land.ogg",win:"/assets/audio/freesound/casino_win.ogg",lose:"/assets/audio/freesound/casino_lose.ogg",chips:"/assets/audio/freesound/chips_clink.ogg"}},this.gameModes={CRAPS:"craps",POKER_DICE:"poker_dice",LIARS_DICE:"liars_dice",FARKLE:"farkle",YAHTZEE:"yahtzee",PIG:"pig"},this.chipValues=[{value:10,color:"white",model:this.assets.chips.white},{value:50,color:"red",model:this.assets.chips.red},{value:100,color:"blue",model:this.assets.chips.blue},{value:500,color:"gold",model:this.assets.chips.gold}],this.playerStats={balance:1e3,totalWon:0,totalLost:0,gamesPlayed:0,biggestWin:0,winStreak:0,currentStreak:0},this.crapsGame={point:null,phase:"come_out",bets:{pass_line:0,dont_pass:0,field:0,come:0,odds:0}},this.pokerHands=[{name:"Five of a Kind",payout:1e3,check:t=>this.checkFiveOfKind(t)},{name:"Four of a Kind",payout:200,check:t=>this.checkFourOfKind(t)},{name:"Full House",payout:100,check:t=>this.checkFullHouse(t)},{name:"Straight",payout:75,check:t=>this.checkStraight(t)},{name:"Three of a Kind",payout:30,check:t=>this.checkThreeOfKind(t)},{name:"Two Pair",payout:15,check:t=>this.checkTwoPair(t)},{name:"One Pair",payout:5,check:t=>this.checkOnePair(t)}],this.achievements=[{id:"lucky_seven",name:"Lucky Seven",description:"Roll a 7 on come out",unlocked:!1},{id:"high_roller",name:"High Roller",description:"Win 5000 in one game",unlocked:!1},{id:"hot_streak",name:"Hot Streak",description:"Win 10 games in a row",unlocked:!1},{id:"five_kind",name:"Quintuple",description:"Roll five of a kind",unlocked:!1},{id:"poker_master",name:"Poker Master",description:"Get all poker hands",unlocked:!1},{id:"farkle_free",name:"Farkle Free",description:"Play 20 Farkle rounds without farkling",unlocked:!1}],this.dicePhysics={gravity:-9.81,restitution:.6,friction:.3,angularDamping:.5}}init(){i.info("DiceGameSystem: Initializing with external assets"),i.info("  - Dice models: Sketchfab Free (4 types)"),i.info("  - Casino tables: Sketchfab Free"),i.info("  - Environment: Quaternius Casino Pack"),i.info("  - UI: Kenney UI Pack + game-icons.net"),this.enabled=!0}startGame(t,e=10){return this.playerStats.balance<e?(i.info("DiceGameSystem: Insufficient balance"),!1):(this.currentGame={mode:t,bet:e,dice:[],rollCount:0,score:0},i.info(`DiceGameSystem: Starting ${t} game with bet ${e}`),!0)}rollDice(t=2,e="standard"){const s=[],a=this.assets.diceModels[e];i.info(`DiceGameSystem: Rolling ${t} ${e} dice (${a})`);for(let n=0;n<t;n++){const o=Math.floor(Math.random()*6)+1;s.push({value:o,model:a,position:{x:Math.random()*2-1,y:5,z:Math.random()*2-1},rotation:{x:Math.random()*360,y:Math.random()*360,z:Math.random()*360},velocity:{x:Math.random()*2-1,y:0,z:Math.random()*2-1},angularVelocity:{x:Math.random()*10,y:Math.random()*10,z:Math.random()*10}})}return this.currentGame.dice=s,this.currentGame.rollCount++,s}playCraps(t,e){(!this.currentGame||this.currentGame.mode!==this.gameModes.CRAPS)&&this.startGame(this.gameModes.CRAPS,e);const s=this.rollDice(2),a=s[0].value+s[1].value;i.info(`DiceGameSystem: Craps roll: ${a} (${s[0].value} + ${s[1].value})`);let n=!1,o=0;return this.crapsGame.phase==="come_out"?a===7||a===11?(n=!0,o=e*2,this.unlockAchievement("lucky_seven")):a===2||a===3||a===12?n=!1:(this.crapsGame.point=a,this.crapsGame.phase="point",i.info(`DiceGameSystem: Point established: ${a}`)):this.crapsGame.phase==="point"&&(a===this.crapsGame.point?(n=!0,o=e*2,this.crapsGame.phase="come_out",this.crapsGame.point=null):a===7&&(n=!1,this.crapsGame.phase="come_out",this.crapsGame.point=null)),this.updateBalance(n,o,e),{win:n,payout:o,total:a,dice:s}}playPokerDice(t){(!this.currentGame||this.currentGame.mode!==this.gameModes.POKER_DICE)&&this.startGame(this.gameModes.POKER_DICE,t);const e=this.rollDice(5,"golden"),s=e.map(c=>c.value).sort((c,l)=>c-l);i.info(`DiceGameSystem: Poker dice: [${s.join(", ")}]`);let a=null,n=0;for(const c of this.pokerHands)if(c.check(s)){a=c,n=t*(c.payout/10);break}const o=a!==null;return this.updateBalance(o,n,t),a&&a.name==="Five of a Kind"&&this.unlockAchievement("five_kind"),{win:o,hand:a?a.name:"No Hand",payout:n,dice:e,values:s}}checkFiveOfKind(t){return t.every(e=>e===t[0])}checkFourOfKind(t){const e=this.getCounts(t);return Object.values(e).includes(4)}checkFullHouse(t){const e=this.getCounts(t),s=Object.values(e).sort();return s.length===2&&s[0]===2&&s[1]===3}checkStraight(t){const e=[...new Set(t)].sort((s,a)=>s-a);return e.length!==5?!1:e[4]-e[0]===4}checkThreeOfKind(t){const e=this.getCounts(t);return Object.values(e).includes(3)}checkTwoPair(t){const e=this.getCounts(t);return Object.values(e).filter(a=>a===2).length===2}checkOnePair(t){const e=this.getCounts(t);return Object.values(e).includes(2)}getCounts(t){const e={};for(const s of t)e[s]=(e[s]||0)+1;return e}updateBalance(t,e,s){this.playerStats.gamesPlayed++,t?(this.playerStats.balance+=e,this.playerStats.totalWon+=e,this.playerStats.currentStreak++,this.playerStats.currentStreak>this.playerStats.winStreak&&(this.playerStats.winStreak=this.playerStats.currentStreak,this.playerStats.winStreak>=10&&this.unlockAchievement("hot_streak")),e>this.playerStats.biggestWin&&(this.playerStats.biggestWin=e,e>=5e3&&this.unlockAchievement("high_roller")),i.info(`DiceGameSystem: Won ${e}! Balance: ${this.playerStats.balance}`)):(this.playerStats.balance-=s,this.playerStats.totalLost+=s,this.playerStats.currentStreak=0,i.info(`DiceGameSystem: Lost ${s}. Balance: ${this.playerStats.balance}`))}unlockAchievement(t){const e=this.achievements.find(s=>s.id===t);e&&!e.unlocked&&(e.unlocked=!0,i.info(`DiceGameSystem: Achievement unlocked: ${e.name}`))}update(t){if(!(!this.enabled||!this.currentGame))for(const e of this.currentGame.dice)e.velocity&&(e.velocity.y+=this.dicePhysics.gravity*t,e.position.x+=e.velocity.x*t,e.position.y+=e.velocity.y*t,e.position.z+=e.velocity.z*t,e.rotation.x+=e.angularVelocity.x*t,e.rotation.y+=e.angularVelocity.y*t,e.rotation.z+=e.angularVelocity.z*t,e.angularVelocity.x*=1-this.dicePhysics.angularDamping*t,e.angularVelocity.y*=1-this.dicePhysics.angularDamping*t,e.angularVelocity.z*=1-this.dicePhysics.angularDamping*t,e.position.y<=0&&(e.position.y=0,e.velocity.y=-e.velocity.y*this.dicePhysics.restitution,e.velocity.x*=1-this.dicePhysics.friction,e.velocity.z*=1-this.dicePhysics.friction,Math.abs(e.velocity.y)<.1&&Math.abs(e.velocity.x)<.1&&Math.abs(e.velocity.z)<.1&&(e.velocity=null)))}getInfo(){return{name:"DiceGameSystem",version:"1.0.0",phase:"Phase 8 - Mini-Games",enabled:this.enabled,gameModes:Object.keys(this.gameModes).length,achievements:this.achievements.length,playerBalance:this.playerStats.balance,gamesPlayed:this.playerStats.gamesPlayed,externalAssets:{models:"Sketchfab Free (dice, tables, chips)",environment:"Quaternius Casino Pack",ui:"Kenney UI Pack + game-icons.net",audio:"Freesound"}}}}export{m as DiceGameSystem};
